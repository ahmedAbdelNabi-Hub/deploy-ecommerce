import{b as N}from"./chunk-EEB4IS4L.js";import{e as P,f as D}from"./chunk-MDAXNIY5.js";import{$ as r,A as f,I as y,L as v,a as u,db as _,ea as o,eb as w,fa as l,ha as n,ja as C,ka as O,la as b,ma as S,na as x,qa as c,r as d,u as h,x as g}from"./chunk-VKIXFHP4.js";import{a as p,b as m}from"./chunk-TSRGIXR5.js";function $(i,e){if(i&1&&b(0,"app-product-card-with-discound",5),i&2){let t=c().$implicit,s=c(2);n("gift",s.gift)("Recently",s.Recently)("productData",t)}}function I(i,e){if(i&1&&(S(0),l(1,$,1,3,"ng-template",4),x()),i&2){let t=e.$implicit;r(),n("id",t.name)}}function L(i,e){if(i&1&&(C(0,"div",1)(1,"owl-carousel-o",2),l(2,I,2,1,"ng-container",3),O()()),i&2){let t,s=c();r(),n("options",s.customOptions),r(),n("ngForOf",(t=s.productsSignal())==null?null:t.data)("ngForTrackBy",s.trackByFn)}}var R=class i{service;methodName;params;autoPlay=!0;itemLarge=4;Recently=!1;gift=!1;destroy$=new u;inProgressRequests=new Map;cache=new Map;params$=new u;productsSignal=o(null);isLoadingSignal=o(!1);hasErrorSignal=o(!1);customOptions={loop:!0,mouseDrag:!0,autoplay:this.autoPlay,touchDrag:!0,pullDrag:!0,dots:!1,navSpeed:1e3,navText:['<i class="bx bxs-chevron-left text-white text-2xl"></i>','<i class="bx bxs-chevron-right text-white text-2xl"></i>'],responsive:{0:{items:1.5},400:{items:2.3},500:{items:2.5},740:{items:3},940:{items:5}},nav:!1};ngOnInit(){this.params$.pipe(d(300),h()).subscribe(()=>{this.loadData()}),this.params&&this.params$.next(this.params)}ngOnChanges(e){(e.params||e.service||e.methodName)&&this.params$.next(this.params),e.autoPlay&&(this.customOptions=m(p({},this.customOptions),{autoplay:this.autoPlay})),e.itemLarge&&(this.customOptions=m(p({},this.customOptions),{responsive:{0:{items:1.5},400:{items:2.3},500:{items:2.5},740:{items:4},940:{items:this.itemLarge}}}))}loadData(){if(!this.service||!this.methodName){console.error("Service and methodName are required!");return}let e=this.generateCacheKey(this.params);if(this.cache.has(e)){this.productsSignal.set(this.cache.get(e)),this.isLoadingSignal.set(!1),this.hasErrorSignal.set(!1);return}if(this.inProgressRequests.has(e)){this.inProgressRequests.get(e).subscribe(a=>{this.productsSignal.set(a)});return}this.isLoadingSignal.set(!0),this.hasErrorSignal.set(!1);let t=this.service[this.methodName];if(typeof t!="function"){console.error(`Method ${this.methodName} is not a function on the provided service.`),this.isLoadingSignal.set(!1),this.hasErrorSignal.set(!0);return}let s=t.call(this.service,this.params).pipe(g(1));this.inProgressRequests.set(e,s),s.pipe(f(this.destroy$)).subscribe({next:a=>{this.cache.set(e,a),this.productsSignal.set(a),this.isLoadingSignal.set(!1),this.inProgressRequests.delete(e)},error:a=>{console.error("Error loading data:",a),this.hasErrorSignal.set(!0),this.isLoadingSignal.set(!1),this.inProgressRequests.delete(e)}})}generateCacheKey(e){return JSON.stringify(e||{})}ngOnDestroy(){this.cache.clear(),this.destroy$.next(),this.destroy$.complete()}trackByFn(e,t){return t.id}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=y({type:i,selectors:[["app-owl-carousel"]],inputs:{service:"service",methodName:"methodName",params:"params",autoPlay:"autoPlay",itemLarge:"itemLarge",Recently:"Recently",gift:"gift"},features:[v],decls:1,vars:1,consts:[["class","relative carousel-1container",4,"ngIf"],[1,"relative","carousel-1container"],[3,"options"],[4,"ngFor","ngForOf","ngForTrackBy"],["carouselSlide","",3,"id"],[1,"card",3,"gift","Recently","productData"]],template:function(t,s){t&1&&l(0,L,3,3,"div",0),t&2&&n("ngIf",s.productsSignal())},dependencies:[_,w,D,P,N],styles:[".tree-gradient[_ngcontent-%COMP%]{background:linear-gradient(19deg,#f2fbfc,#fff,#fff,#e5f53979)}"],changeDetection:0})};export{R as a};
