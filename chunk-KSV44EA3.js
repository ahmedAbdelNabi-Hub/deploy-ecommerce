import{a as e}from"./chunk-MDAXNIY5.js";import{B as s,D as d,G as p,b as n,h as i,ob as h,p as u,pb as I,x as l}from"./chunk-VKIXFHP4.js";var P=class a{constructor(t){this._Http=t}dataCache=null;newArrivalsCache=null;recentlyProductsCache$=new n(null);getProductsOnOfferGroupedByCategory(){return this.dataCache?i(this.dataCache):this._Http.get(`${e.Localhost+e.prodcut}offers/grouped`).pipe(s(t=>{this.dataCache=t}),u(t=>i([])))}activateProduct(t){return this._Http.patch(`${e.Localhost+e.prodcut}${t}/activate`,{})}getProductAttributes(t){return this._Http.get(`${e.Localhost+e.prodcut}${t}/attributes`)}getProductWithIdAndStoreInRedis(t,r){let o=this.getUserViewProduct(),c=new h().set("viewId",o.viewId).set("isStoreInRedis",r.toString());return this._Http.get(`${e.Localhost+e.prodcut}${t}`,{params:c})}getAllProduct(t){return t?this._Http.get(`${e.Localhost+e.prodcut}?CategoryName=${t.CategoryName}&PageIndex=${t.PageIndex}&PageSize=${t.PageSize}`):i()}getAllFilterWithCategoy(t){return this._Http.get(`${e.Localhost+e.filter}?categoryName=${t}`)}createProduct(t){let r=`${e.Localhost+e.prodcut}`;return console.log(r),console.log([...t].map(([o,c])=>({key:o,value:c}))),this._Http.post(r,t)}deleteProduct(t){let r=`${e.Localhost+e.prodcut}${t}`;return this._Http.delete(r)}updateProduct(t,r){let o=`${e.Localhost+e.prodcut}`;return this._Http.put(`${o}${t}`,r)}getUserViewProduct(){let t=localStorage.getItem("viewKey");return t?{IsStoreInRedis:!0,viewId:t,ProductReadDto:[]}:this.createNewViewForUser()}createNewViewForUser(){let t=crypto.randomUUID(),r={IsStoreInRedis:!0,viewId:t,ProductReadDto:[]};return localStorage.setItem("viewKey",r.viewId),console.log("New View ID stored: ",t),r}GetRecentlyProducts(){if(this.recentlyProductsCache$.value)return i(this.recentlyProductsCache$.value);let t=this.getUserViewProduct().viewId;return this._Http.get(`${e.Localhost+e.prodcut}recent/${t}`).pipe(s(r=>this.recentlyProductsCache$.next(r)),l(1))}clearCache(){this.newArrivalsCache=null,this.recentlyProductsCache$.next(null),this.dataCache=null}static \u0275fac=function(r){return new(r||a)(p(I))};static \u0275prov=d({token:a,factory:a.\u0275fac,providedIn:"root"})};export{P as a};
